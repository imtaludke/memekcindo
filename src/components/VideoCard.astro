---
// src/components/VideoCard.astro
import { slugify } from '../utils/slugify';
import { url } from '../utils/site.ts';

interface Props {
  video: {
    id: string;
    title: string;
    thumbnail: string;
    thumbnailWidth?: number;
    thumbnailHeight?: number;
    category: string;
    duration?: number;
    // Removed: views: number;
    // Add any other properties from VideoData that VideoCard might use
  };
  videoDetailPath: string;
}

const { video, videoDetailPath } = Astro.props;

// Format duration from seconds to MM:SS
function formatDuration(seconds: number): string {
  const minutes = Math.floor(seconds / 60);
  const remainingSeconds = seconds % 60;
  return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
}

const formattedDuration = formatDuration(video.duration);

// Removed: formatViews function and its usage
// const formattedViews = formatViews(video.views);
---

<div class="video-card" itemprop="video" itemscope itemtype="http://schema.org/VideoObject">
  <meta itemprop="uploadDate" content={new Date().toISOString()} /> {/* Placeholder: You might want to add actual date */}
  <meta itemprop="duration" content={`PT${video.duration}S`} />
  <meta itemprop="name" content={video.title} />
  <meta itemprop="description" content={`Video ${video.title} in category ${video.category}.`} />

  <a href={`${url}${videoDetailPath}`} class="video-thumbnail-link">
    <div class="video-thumbnail-wrapper">
      <img
        src={video.thumbnail}
        alt={`Thumbnail for ${video.title}`}
        title={`${video.title} - ${formattedDuration}`}
        width={video.thumbnailWidth}
        height={video.thumbnailHeight}
        loading="lazy"
        itemprop="thumbnailUrl"
      />
      <span class="video-duration">{formattedDuration}</span>
    </div>
  </a>
  <div class="video-info">
    <h3 class="video-title" itemprop="name">
      <a href={`${url}${videoDetailPath}`}>{video.title}</a>
    </h3>
    <p class="video-meta">
      {/* Removed: <span class="video-views" itemprop="interactionCount">{formattedViews}</span> */}
      <span class="video-category">
        <a href={`${url}/category/${slugify(video.category)}/1`} itemprop="isPartOf">
          {video.category}
        </a>
      </span>
    </p>
  </div>
</div>
